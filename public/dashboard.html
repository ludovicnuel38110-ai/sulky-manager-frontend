<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Sulky-Bet – Dashboard</title>
<link rel="stylesheet" href="style.css">

<style>

/* ================= BACKGROUND ================= */

body{
  background:
    linear-gradient(rgba(0,0,0,.65), rgba(0,0,0,.85)),
    url("images/bg.jpg");
  background-size:cover;
  background-position:center;
  background-attachment:fixed;
  font-family: "Segoe UI", Arial, sans-serif;
}


/* ================= HEADER PRO ================= */

.main-header{
  display:flex;
  justify-content:space-between;
  align-items:center;

  background:#0b0f14;
  border-bottom:2px solid #0fbf9f;

  padding:16px 40px;
}

.logo-text{
  font-size:32px;
  font-weight:800;
  letter-spacing:2px;
  color:#0fbf9f;
}

.header-actions button{
  background:#0fbf9f;
  color:#001a16;
  border:none;
  padding:10px 18px;
  border-radius:8px;
  font-weight:600;
  cursor:pointer;
}

.header-actions button:hover{
  opacity:.85;
}


/* ================= LAYOUT ================= */

.dashboard-wrapper{
  max-width:1150px;
  margin:70px auto;
  padding:25px;
}


/* ================= MAIN CARD ================= */

.dashboard-card{
  background:rgba(10,18,24,.9);
  border-radius:18px;
  padding:50px;

  border:1px solid rgba(15,191,159,.35);
  backdrop-filter:blur(8px);
}


/* ================= TITRES ================= */

#welcome{
  font-size:30px;
  margin-bottom:10px;
}

#balance{
  font-size:20px;
  color:#0fbf9f;
  margin-bottom:40px;
}


/* ================= GRID ================= */

.actions-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:18px;
}


/* ================= BUTTON CARDS (PRO) ================= */

.big-btn{
  background:#101820;
  border:1px solid rgba(15,191,159,.35);

  padding:22px;
  border-radius:12px;

  font-size:16px;
  font-weight:600;
  color:#e9f7f5;

  cursor:pointer;
  transition:.2s;
}

.big-btn:hover{
  background:#0fbf9f;
  color:#001a16;
  transform:translateY(-2px);
}


/* ================= INFO BOX ================= */

.welcome-box{
  margin-top:40px;
  padding:25px;

  background:#0d151c;
  border-radius:12px;
  font-size:14px;
  line-height:1.7;
  color:#cfd8dc;
}


/* ================= ADMIN ================= */

#adminPanel{
  display:none;
  margin-top:40px;
}

.admin-title{
  margin-bottom:15px;
  color:#0fbf9f;
  font-weight:700;
}


/* ================= MOBILE ================= */

@media(max-width:700px){
  .dashboard-card{ padding:30px; }
}

</style>
</head>

<body>


<!-- HEADER -->
<header class="main-header">
  <div class="logo-text">SULKY-BET</div>

  <div class="header-actions">
    <button onclick="location.href='actus.html'">Actualités</button>
    <button id="logoutBtn">Déconnexion</button>
  </div>
</header>



<!-- DASHBOARD -->
<div class="dashboard-wrapper">

  <div class="dashboard-card">

    <h1 id="welcome">Bienvenue</h1>
    <div id="balance">Solde : ... €</div>


    <!-- ACTIONS -->
    <div class="actions-grid">

      <button class="big-btn" id="btnRaces">Courses</button>
      <button class="big-btn" id="btnHistory">Mes paris</button>
      <button class="big-btn" id="btnResults">Résultats</button>
      <button class="big-btn" id="btnAide">Aide</button>

      <!-- admin only -->
      <button class="big-btn" id="btnAdminBets">Tous les paris</button>

    </div>



    <!-- INFO TEXT -->
    <div class="welcome-box">
      Sulky-Bet est une plateforme indépendante de gestion de paris hippiques.  
      Accédez aux courses, placez vos paris et suivez vos performances en temps réel dans un environnement simple, rapide et sécurisé.

      <br><br>

      Le site est un projet personnel. Sulkyland n’intervient pas dans la gestion technique du service.
    </div>



    <!-- ADMIN PANEL -->
    <div id="adminPanel">

      <div class="admin-title">Administration</div>

      <div class="actions-grid">
        <button class="big-btn" onclick="location.href='admin-courses.html'">Gérer les courses</button>
        <button class="big-btn" onclick="location.href='admin-settle.html'">Régler une course</button>
        <button class="big-btn" onclick="location.href='admin-balance.html'">Créditer joueur</button>
      </div>

    </div>

  </div>

</div>



<script>
document.addEventListener("DOMContentLoaded", async () => {

  const token = localStorage.getItem("token");
  if(!token) return location.href="login.html";

  const welcome = document.getElementById("welcome");
  const balanceBox = document.getElementById("balance");
  const adminPanel = document.getElementById("adminPanel");

  const res = await fetch(
    "https://sulky-manager-backend.onrender.com/api/users/me",
    { headers:{ Authorization:"Bearer "+token } }
  );

  const user = await res.json();

  welcome.innerText = "Bienvenue " + user.pseudo;
  balanceBox.innerText = "Solde : " + user.balance + " €";

  const payload = JSON.parse(atob(token.split(".")[1]));
  if(payload.isAdmin) adminPanel.style.display = "block";

  btnRaces.onclick   = ()=>location.href="races.html";
  btnHistory.onclick = ()=>location.href="history.html";
  btnResults.onclick = ()=>location.href="results.html";
  btnAide.onclick    = ()=>location.href="aide.html";
  btnAdminBets.onclick = ()=>location.href="admin-bets.html";

  logoutBtn.onclick = ()=>{
    localStorage.clear();
    location.href="index.html";
  };

});
</script>

</body>
</html>
